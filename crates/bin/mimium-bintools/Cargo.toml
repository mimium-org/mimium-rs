[package]
name = "mimium-bintools"
edition.workspace = true
license.workspace = true
version.workspace = true
repository.workspace = true
readme.workspace = true
authors.workspace = true
description = "binary executable packages of mimium languages."
build = "build.rs"

[package.metadata.dist]
# Include plugin cdylibs by copying them from target directory
[[package.metadata.dist.extra-artifacts]]
build = ["sh", "./copy-plugins.sh"]
artifacts = [
    "libmimium_symphonia.dylib",
    "libmimium_symphonia.so",
    "mimium_symphonia.dll",
    "libmimium_midi.dylib",
    "libmimium_midi.so",
    "mimium_midi.dll",
    "libmimium_guitools.dylib",
    "libmimium_guitools.so",
    "mimium_guitools.dll",
]

[dependencies]
mimium-cli = { workspace = true }
mimium-fmt = { workspace = true }

[target.'cfg(not(target_arch = "wasm32"))'.dependencies]
mimium-language-server = { workspace = true }
tokio = { version = "1.17.0", features = ["full"] }
# Plugin dependencies to ensure they're built
mimium-symphonia = { path = "../../lib/plugins/mimium-symphonia", version = "3.2.0", default-features = false }
mimium-midi = { path = "../../lib/plugins/mimium-midi", version = "3.2.0", default-features = false }
mimium-guitools = { path = "../../lib/plugins/mimium-guitools", version = "3.2.0", default-features = false }

[[bin]]
name = "mimium-cli"
path = "src/cli/bin/main.rs"
[[bin]]
name = "mimium-fmt"
path = "src/fmt/bin/main.rs"
[[bin]]
name = "mimium-language-server"
path = "src/language-server/bin/main.rs"
